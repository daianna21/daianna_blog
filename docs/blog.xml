<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Daianna Gonzalez-Padilla</title>
<link>https://daianna21.github.io/daianna_blog/blog.html</link>
<atom:link href="https://daianna21.github.io/daianna_blog/blog.xml" rel="self" type="application/rss+xml"/>
<description>Daianna&#39;s personal scientific blog</description>
<generator>quarto-1.4.555</generator>
<lastBuildDate>Tue, 16 Jul 2024 06:00:00 GMT</lastBuildDate>
<item>
  <title>MAGMA: How does the Gene and the Gene-Set analysis operate?</title>
  <dc:creator>Daianna Gonzalez-Padilla</dc:creator>
  <link>https://daianna21.github.io/daianna_blog/posts/2024-07-16-MAGMA/</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>MAGMA&nbsp;stands for&nbsp;<strong>Multi-marker Analysis of GenoMic Annotation</strong>&nbsp;and is a computational tool for the analysis of the joint effect of multiple genetic markers on a phenotype based on Genome-Wide Association Study (GWAS) data. MAGMA constitutes a flexible and generalizable approach to assess the&nbsp;<strong>association</strong>&nbsp;of&nbsp;<u><strong>individual genes</strong></u>&nbsp;or&nbsp;<u><strong>gene-sets</strong></u>&nbsp;with a&nbsp;<strong>phenotype</strong>&nbsp;based on the associations that the&nbsp;<u><strong>SNPs</strong></u>&nbsp;of the genes have with the same phenotype.</p>
<p>This is a commonly used method that you‚Äôll likely find implemented while reading about GWASes or that you‚Äôll need to run if working with genetic variant associations and gene-set enrichment analysis, so let‚Äôs see how it works.</p>
</section>
<section id="what-youll-learn-here" class="level1">
<h1>What you‚Äôll learn here</h1>
<ol type="1">
<li><p>Global description of the analyses MAGMA allows to run at gene and gene-set levels.</p></li>
<li><p>A more detailed demonstration of the SNP-wise gene analysis implemented in MAGMA: inputs, commands and outputs ‚Ä¶.</p></li>
<li><p>TODO</p></li>
</ol>
</section>
<section id="how-does-it-work" class="level1">
<h1>How does it work?</h1>
<p>MAGMA allows to first perform a gene analysis and subsequently a gene-set analysis based on gene-level results. Note, however, that the gene-set analysis comes as a separate layer and it is an additional optional step, though it is frequently performed and quite useful.</p>
<section id="gene-analysis" class="level2">
<h2 class="anchored" data-anchor-id="gene-analysis"><strong>Gene analysis</strong></h2>
<p>Genetic markers are aggregated to the level of whole individual genes and those in a given gene are jointly tested for their association with the phenotype, defining in such way the association of the gene itself. This definitely allows to detect significant associations of multiple small-effect markers in a gene that individually would be missed, i.e., associations that depend on multiple markers. This also reduces the number of required tests and makes the results more interpretable by summarizing at the gene level.</p>
<p>Two alternatives for gene analysis are offered by MAGMA:</p>
<section id="multiple-linear-pc-regression-model" class="level3">
<h3 class="anchored" data-anchor-id="multiple-linear-pc-regression-model"><span style="color:#FF7256"><strong>Multiple linear PC regression model</strong></span></h3>
<p>If the input data is <strong>raw genotype data</strong>, MAGMA fits a multiple linear PC regression model to the individuals‚Äô phenotypes. Here, for one gene <img src="https://latex.codecogs.com/png.latex?g"> at a time, the SNP matrix that contains the information of the SNPs for that gene across all the <img src="https://latex.codecogs.com/png.latex?N"> individuals studied, is projected onto its Principal Components (PCs). These PCs capture genotypic differences between individuals for the given gene and the first <img src="https://latex.codecogs.com/png.latex?K"> most explanatory ones (comprising 99.9% of the variance) are used as predictors of the phenotype (<img src="https://latex.codecogs.com/png.latex?Y">) in the linear model.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://daianna21.github.io/daianna_blog/posts/2024-07-16-MAGMA/images/MAGMA_PC_model.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="650"></p>
</figure>
</div>
<p>Phenotype is modeled as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AY%20=%20%5Calpha_%7B0g%7D+X%5E*_%7Bg%7D%5Calpha_g+W%5Cbeta_g+%5Cepsilon_g%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7B%5Cbegin%7Bbmatrix%7DY_1%20%5C%5C%20...%20%5C%5C%20Y_%7BN-1%7D%20%5C%5C%20Y_N%5Cend%7Bbmatrix%7D%7D%20=%20%7B%5Cbegin%7Bbmatrix%7D%5Calpha_%7B0g%7D%20%5C%5C%20...%20%5C%5C%20%5Calpha_%7B0g%7D%20%5C%5C%20%5Calpha_%7B0g%7D%5Cend%7Bbmatrix%7D%7D%20+%20%5Cstackrel%7BPC1%20%5C%20%5C%20%20%5C%20%5C%20%20%5C%20%5C%20PC2%20%5C%20%5C%20%20%5C%20%5C%20%20%5C%20%5C%20...%20%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20PC_K%7D%20%7B%5Cbegin%7Bbmatrix%7D%20%20x_%7B11%7D%20%5C%20%5C%20x_%7B12%7D%20%5C%20%5C%20...%20%5C%20%5C%20x_%7B1K%7D%20%20%5C%5C%20%20...%20%5C%5C%20x_%7B(N-1)1%7D%20%5C%20%5C%20x_%7B(N-1)2%7D%20%5C%20%5C%20...%20%5C%20%5C%20x_%7B(N-1)K%7D%20%5C%5C%20%20x_%7BN1%7D%20%5C%20%5C%20x_%7BN2%7D%20%5C%20%5C%20...%20%5C%20%5C%20x_%7BNK%7D%20%5Cend%7Bbmatrix%7D%7D%20%7B%5Cbegin%7Bbmatrix%7D%5Calpha_%7Bg1%7D%20%5C%5C%20%20%5Calpha_%7Bg2%7D%20%5C%5C%20...%20%5C%5C%20%5Calpha_%7BgK%7D%5Cend%7Bbmatrix%7D%7D%20+%20%20%5Cstackrel%7BCov1%20%5C%20%5C%20%20%5C%20%5C%20%20%5C%20%5C%20Cov2%20%5C%20%5C%20%20%5C%20%5C%20%20%5C%20%5C%20...%20%20%5C%20%5C%20%5C%20%5C%20%5C%20%5C%20CovL%7D%7B%5Cbegin%7Bbmatrix%7D%20%20w_%7B11%7D%20%5C%20%5C%20w_%7B12%7D%20%5C%20%5C%20...%20%5C%20%5C%20w_%7B1L%7D%20%20%5C%5C%20%20...%20%5C%5C%20w_%7B(N-1)1%7D%20%5C%20%5C%20w_%7B(N-1)2%7D%20%5C%20%5C%20...%20%5C%20%5C%20w_%7B(N-1)L%7D%20%5C%5C%20%20w_%7BN1%7D%20%5C%20%5C%20w_%7BN2%7D%20%5C%20%5C%20...%20%5C%20%5C%20w_%7BNL%7D%20%5Cend%7Bbmatrix%7D%7D%7B%5Cbegin%7Bbmatrix%7D%5Cbeta_%7Bg1%7D%20%5C%5C%20%20%5Cbeta_%7Bg2%7D%20%5C%5C%20...%20%5C%5C%20%5Cbeta_%7BgL%7D%5Cend%7Bbmatrix%7D%7D%20+%0A%7B%5Cbegin%7Bbmatrix%7D%5Cepsilon_%7Bg1%7D%20%5C%5C%20...%20%5C%5C%20%5Cepsilon_%7Bg(N-1)%7D%20%5C%5C%20%20%5Cepsilon_%7BgN%7D%5Cend%7Bbmatrix%7D%7D%0A"></p>
<p>With <img src="https://latex.codecogs.com/png.latex?X_%7Bg%7D%5E*"> the matrix of the first <img src="https://latex.codecogs.com/png.latex?K"> PCs for gene <img src="https://latex.codecogs.com/png.latex?g"> and <img src="https://latex.codecogs.com/png.latex?W"> a matrix of additional covariates for the individuals that can be included in the model. <img src="https://latex.codecogs.com/png.latex?%5Calpha_g">‚Äôs and <img src="https://latex.codecogs.com/png.latex?%5Cbeta_g">‚Äôs are the coefficients of the PCs and covariates for the gene <img src="https://latex.codecogs.com/png.latex?g">, respectively. <img src="https://latex.codecogs.com/png.latex?%5Cepsilon_g"> is the vector of residuals and <img src="https://latex.codecogs.com/png.latex?%5Calpha_%7B0g%7D"> the intercept. The <img src="https://latex.codecogs.com/png.latex?%5Calpha_g">‚Äôs represent the effect of the genotype for gene <img src="https://latex.codecogs.com/png.latex?g"> on the phenotype (the <strong>genetic effect</strong>).</p>
<p>Then an F-test is used to assess if genotypes for gene <img src="https://latex.codecogs.com/png.latex?g"> have an effect on the phenotype under the null hypothesis that the genetic effect of <img src="https://latex.codecogs.com/png.latex?g"> on the phenotype is 0 across all PCs (<img src="https://latex.codecogs.com/png.latex?H_0:%5Calpha_g=%5Coverrightarrow%200">). This leads to a <em>p</em>-value for the association of gene <img src="https://latex.codecogs.com/png.latex?g"> with the phenotype <img src="https://latex.codecogs.com/png.latex?Y"> based on its genetic markers.</p>
<div style="background-color:#F2F2F2; padding: 15px">
<p>‚úîÔ∏è The advantage of using PCs instead of variables for individual SNPs is that 1) the number of variables included in the linear model is reduced and 2) they allow to account for redundancy and collinearity between SNPs. Also this model offers flexibility to accommodate additional covariates to model the phenotype.</p>
</div>
</section>
<section id="snp-wise-gene-analysis" class="level3">
<h3 class="anchored" data-anchor-id="snp-wise-gene-analysis"><span style="color:#7AC5CD"><strong>SNP-wise gene analysis</strong></span></h3>
<p>If no raw genotype data is available, MAGMA also accepts <u><strong>SNP <em>p</em>-values</strong></u> from a GWAS as input. In this case SNP <em>p</em>-values for a gene are first transformed into <u><strong>Z or</strong> <img src="https://latex.codecogs.com/png.latex?%5Cchi%5E2"><strong>statistics</strong></u> and then combined into a <u><strong>gene test-statistic</strong></u> by the <span style="background-color: #F0FFF0"><strong>mean SNP statistic</strong></span> or <span style="background-color:#FFF0F5"><strong>top SNP statistic</strong></span> method. This gene test-statistic is then used to compute the <u><strong>gene <em>p</em>-value</strong></u>, either by an approximation of the sampling distribution (mean SNP statistic method) or by phenotype permutation (mean and top SNP statistic methods).</p>
<p>This SNP-wise MAGMA analysis based on SNP summary statistics requires a <strong>reference dataset</strong> with similar ancestry as the data from which SNPs <em>p</em>-values were computed. This is needed to account for LD between SNPs. If an approximation of the sampling distribution is used to compute the gene <em>p</em>-value, this reference is required to obtain the SNP statistic correlation matrix <img src="https://latex.codecogs.com/png.latex?R">. If phenotype permutation is chosen, these reference data are necessary to generate the gene test-statistics empirical sampling distribution.</p>
<div style="background-color:#F2F2F2; padding: 15px">
<p>Summary: SNP <em>p</em>-values ‚Üí SNP statistics ‚Üí<span style="color:#EE00EE"><strong>*</strong></span>gene test-statistic ‚Üí<span style="color: #00CD00"><strong>*</strong></span> gene <em>p</em>-value ‚Üí gene <em>z</em>-score (<img src="https://latex.codecogs.com/png.latex?z_g">)</p>
</div>
<p><span style="color:#EE00EE"><strong>*</strong></span>Gene test-statistics can be constructed from the SNP statistics applying one of two implemented methods in MAGMA:</p>
<ul>
<li><p><span style="background-color: #F0FFF0"><strong>Mean SNP statistic</strong></span>:</p>
<ul>
<li><p><strong>Mean Z gene test-statistic</strong>: SNP <em>p</em>-values of a gene are transformed to Z-statistics and the mean (weighted or unweighted sum) of such Z-stats is used as the test-statistic of the gene: <img src="https://latex.codecogs.com/png.latex?T=%5Csum_i%5EG%20w_iz_i">, with <img src="https://latex.codecogs.com/png.latex?G"> the total number of SNPs of the gene and <img src="https://latex.codecogs.com/png.latex?z_i"> and <img src="https://latex.codecogs.com/png.latex?w_i"> the Z-statistic and weight for SNP <img src="https://latex.codecogs.com/png.latex?i">, respectively. These gene test-stats follow a normal distribution.</p></li>
<li><p><strong>Mean</strong> <img src="https://latex.codecogs.com/png.latex?%5Cchi%5E2"> <strong>gene test-statistic</strong>: the mean (weighted or unweighted sum) of the <img src="https://latex.codecogs.com/png.latex?-2log"> of the SNP <em>p</em>-values (that are <img src="https://latex.codecogs.com/png.latex?%5Csim%5Cchi%5E2_%7B(2)%7D">) is used as gene test-statistic: <img src="https://latex.codecogs.com/png.latex?T=-2%5Csum_i%5EG%20w_i%5Clog(p_i)">, with <img src="https://latex.codecogs.com/png.latex?p_i"> the <em>p</em>-value of SNP <img src="https://latex.codecogs.com/png.latex?i">. These gene test-stats are assumed to be <img src="https://latex.codecogs.com/png.latex?%5Csim%20c%5Cchi%5E2_%7B(f)%7D">, where <img src="https://latex.codecogs.com/png.latex?c"> and <img src="https://latex.codecogs.com/png.latex?f"> are constants of the distribution.</p></li>
</ul>
<p><span style="color: #00CD00"><strong>*</strong></span>For both mean Z and mean <img src="https://latex.codecogs.com/png.latex?%5Cchi%5E2"> gene test-statistics the <em>p</em>-value of the gene is obtained based on a known <strong>approximation of the sampling distribution</strong> of the gene test-stats. For such purposes, the reference dataset is needed to estimate the SNP statistic correlation matrix, from which the optional SNP weights (<img src="https://latex.codecogs.com/png.latex?w_i">) are computed to correct for dependency between SNPs. A phenotype permutation procedure can also be applied to compute empirical gene <em>p</em>-values (see further below).</p></li>
<li><p><span style="background-color:#FFF0F5"><strong>Top SNP statistic(s)</strong></span>: the lowest SNP <em>p</em>-value among all SNPs in the gene (corresponding to the most associated SNP) or the sum of the <img src="https://latex.codecogs.com/png.latex?-log(p)"> for the top most associated SNPs is used as the gene test-statistic.</p>
<p><span style="color: #00CD00"><strong>*</strong></span>To compute the gene <em>p</em>-value a <strong>phenotype permutation</strong> procedure is the only option available. Here random phenotypes are assigned to the reference data and a top gene test-statistic is computed in each permutation. The empirical gene <em>p</em>-value is computed as the proportion of these permuted gene test-statistics that are higher than the observed one.</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The SNP-wise gene analysis of MAGMA can also be run with raw genotype data, in which case SNP <em>p</em>-values are computed internally and the raw genotype data takes place of the reference data.</p>
</div>
</div>
<p>After running the gene analysis, either by PC regression or SNP-wise analysis, the resulting gene <em>p</em>-values are subsequently transformed to z-scores (<img src="https://latex.codecogs.com/png.latex?z_g">) to be introduced in the gene-set analysis. These z-scores capture the association of the genes with the phenotype. (HEREEEEE)</p>
</section>
</section>
<section id="gene-set-analysis" class="level2">
<h2 class="anchored" data-anchor-id="gene-set-analysis">Gene-set analysis</h2>
<p>Once having gene-level associations, we can now think of gene set associations. Intiatlly, we aggregate genes in groups of genes that share cellular or functional properties, such as involvements in certain biological processes, with particular molecular functions, cellular locations, cell-type specific expression or activity, or differential expression for a given condition. These define concrete processes or features we may be interested in relating with a GWAS phenotype. By doing this, we can gain insights into the potential molecules, pathways, and tissues implicated in a phenotype‚Äôs etiology.</p>
<p>Since all that‚Äôs necessary from the gene analysis to run the gene-set analysis are the gene <em>z</em>-scores, gene-set analysis operates the same independently of the gene analysis method applied (PC regression or SNP-wise), as both result in gene <em>p</em>-values and respective <em>z</em>-scores.</p>
<p>Two gene-level regression models are implemented:</p>
<p>Genes of our particular interest are in turn aggregated into gene sets depending on their biological functions or other shared characteristics/involvements (such as being up/down DEGs). Analyzing gene sets evidently reduces the number of output tests but the gene analysis still has to be performed.</p>
</section>
</section>
<section id="example-of-snp-wise-gene-analysis-and-competitive-gene-set-analysis" class="level1">
<h1>Example of SNP-wise gene analysis and competitive gene-set analysis</h1>
<p>By default the SNP-wise gene analysis method implemented is the mean Z gene test-statistic, and the default gene-set analysis is the competitive one. Let‚Äôs exemplify how to run these analyses. The following are the three main steps implemented by MAGMA.</p>
<section id="step-1-annotation-of-snps-onto-genes" class="level2">
<h2 class="anchored" data-anchor-id="step-1-annotation-of-snps-onto-genes">Step 1: Annotation of SNPs onto genes</h2>
<p>The first step is to map all SNPs from your GWAS data onto the genes of a reference genome.</p>
<ul>
<li><p><strong>Input</strong>: we need SNP and gene positions based on the same human genome reference build; we provide this in the&nbsp;<code>.snploc</code>&nbsp;and in the&nbsp;<code>.gene.loc</code>&nbsp;files, respectively.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode Bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## .snploc file example</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Columns: SNP ID, Chr, Position:</span></span>
<span id="cb1-3"></span>
<span id="cb1-4">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">SNP</span> CHR         BP </span>
<span id="cb1-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rs62513865</span>   8  101592213 </span>
<span id="cb1-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rs79643588</span>   8  106973048 </span>
<span id="cb1-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rs17396518</span>   8  108690829 </span>
<span id="cb1-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rs983166</span>     8  108681675 </span>
<span id="cb1-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rs28842593</span>   8  103044620 </span>
<span id="cb1-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rs7014597</span>    8  104152280 </span>
<span id="cb1-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rs3134156</span>    8  100479917 </span>
<span id="cb1-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rs6980591</span>    8  103144592 </span>
<span id="cb1-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rs72670434</span>   8  108166508</span></code></pre></div>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode Bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## .gene.loc file example</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Required columns: GeneID, Chr, Start site, Stop site:</span></span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ENSG00000243485</span> 1 29554 31109 + MIR1302-2HG </span>
<span id="cb2-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ENSG00000186092</span> 1 65419 71585 + OR4F5 </span>
<span id="cb2-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ENSG00000238009</span> 1 89295 133723 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> AL627309.1 </span>
<span id="cb2-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ENSG00000239906</span> 1 139790 140339 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> AL627309.2 </span>
<span id="cb2-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ENSG00000236601</span> 5 180881343 180888537 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> AL732372.1 </span>
<span id="cb2-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ENSG00000235146</span> 1 523009 530148 + AC114498.1 </span>
<span id="cb2-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ENSG00000229905</span> 1 696291 697369 + AL669831.2 </span>
<span id="cb2-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ENSG00000237491</span> 1 714150 745440 + AL669831.5</span></code></pre></div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>SNPs in sexual chromosomes are usually excluded from the analysis as their inclusion brings additional analytical, statistical, and bioinformatic challenges for their analysis <span class="citation" data-cites="sun2023">(Sun et al. 2023)</span>. MAGMA only supports X chromosome analysis.</p>
</div>
</div></li>
<li><p><strong>Commands</strong>: the following are the flags and inputs used to map the SNPs onto genes.</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode Bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Run SNP annotation: </span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## --annotate: flag to run annotation </span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## --snp-loc: indicate file with SNP positions</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## --gene-loc: indicate file with gene positions</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## --out: prefix for output files</span></span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">magma</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--annotate</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\ </span></span>
<span id="cb3-8">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--snp-loc</span> [.snploc file]<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\ </span></span>
<span id="cb3-9">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--gene-loc</span> [gene.loc file]<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\ </span></span>
<span id="cb3-10">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--out</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">output_prefix</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div></li>
<li><p><strong>Output</strong>: this step returns the <code>.genes.annot</code> file as output, containing all SNPs that were assigned to a gene.</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode Bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## .genes.annot file example</span></span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## GeneID Chr:Start:Stop and corresponding SNP rsIDs:</span></span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">window_up</span> = 0 </span>
<span id="cb4-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">window_down</span> = 0 </span>
<span id="cb4-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ENSG00000237491</span> 1:714150:745440 rs186002080 rs12184267 rs142557973 rs149887893 </span>
<span id="cb4-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ENSG00000177757</span> 1:752751:755217 rs3115859 rs3131968 rs3131967 rs3115860 </span>
<span id="cb4-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ENSG00000225880</span> 1:761586:762902 rs2286139 rs377377186 rs374493323 </span>
<span id="cb4-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ENSG00000230368</span> 1:803451:812283 rs11240779 rs28410559 rs72631880 rs58686784 </span></code></pre></div></li>
</ul>
</section>
<section id="step-2-snp-wise-gene-analysis" class="level2">
<h2 class="anchored" data-anchor-id="step-2-snp-wise-gene-analysis">Step 2: SNP-wise gene analysis</h2>
<ul>
<li><p><strong>Input</strong>: we need to provide the SNP <em>p</em>-values in the <code>.pval</code> file and the gene-wise SNPs in the <code>.genes.annot</code> file obtained in the previous step. A reference dataset must be provided as well.</p>
<p>The total sample size (N) of the GWAS from which the SNP <em>p</em>-values were derived must be indicated as well using the <em>N</em> modifier of <code>--pval</code>. Alternatively, if different sample sizes were used per SNP, these can be contained in a separate column of the <code>.pval</code> file which specified in the <em>ncol</em> modifier of <code>--pval</code>.</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode Bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## .pval file example</span></span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Columns: SNP ID, SNP p-value, and optionally SNP sample size </span></span>
<span id="cb5-3"></span>
<span id="cb5-4">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">SNP</span>      P      N </span>
<span id="cb5-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rs62513865</span> 0.4847 130644 </span>
<span id="cb5-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rs79643588</span> 0.5605 130644 </span>
<span id="cb5-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rs17396518</span> 0.8145 130644 </span>
<span id="cb5-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rs983166</span>   0.5704 130644 </span>
<span id="cb5-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rs28842593</span> 0.7488 130644 </span>
<span id="cb5-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rs7014597</span>  0.5034 130644 </span>
<span id="cb5-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rs3134156</span>  0.2225 130644</span></code></pre></div>
<p>The next is a <code>head</code> of the 1000 Genomes European panel data used as the reference dataset.</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode Bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## g1000_eur reference data example</span></span>
<span id="cb6-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Columns: Chr, SNP ID, Genetic distance, Position, Allele1, Allele2</span></span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span> rs537182016 0 10539 A C </span>
<span id="cb6-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span> rs575272151 0 11008 G C </span>
<span id="cb6-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span> rs544419019 0 11012 G C </span>
<span id="cb6-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span> rs540538026 0 13110 A G </span>
<span id="cb6-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span> rs62635286  0 13116 G T </span>
<span id="cb6-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span> rs200579949 0 13118 G A </span></code></pre></div></li>
<li><p><strong>Commands</strong>: these are the flags used to run the SNP-wise mean Z stats method.</p>
<p>## Reference data used was the 1000 Genomes European data</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode Bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Run gene analysis based on SNP p-values</span></span>
<span id="cb7-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## --bfile</span></span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## --pval</span></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## --gene-annot</span></span>
<span id="cb7-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## --out</span></span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">magma</span> </span>
<span id="cb7-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--bfile</span> g1000_eur<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\ </span></span>
<span id="cb7-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## SNP p-values as input; </span></span>
<span id="cb7-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## indicate colname for sample size of the study (N) </span></span>
<span id="cb7-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--pval</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$ANNOT_PREFIX</span>.pval ncol=N<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\ </span></span>
<span id="cb7-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Provide output file from step 1 with gene SNPs </span></span>
<span id="cb7-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--gene-annot</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTPUT_PREFIX</span>.genes.annot<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\ </span></span>
<span id="cb7-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--out</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTPUT_PREFIX</span></span></code></pre></div></li>
</ul>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
</section>
<section id="relevant-links" class="level1">
<h1>Relevant links</h1>
<div style="background-color: #F8F8FF;  padding: 14px; margin-left: 0px; margin-bottom: 1px; font-size: 15px; line-height: 1.3">
<div class="line-block">üìë <strong>Original publication for MAGMA:</strong><br>
de Leeuw, C. A., Mooij, J. M., Heskes, T., &amp; Posthuma, D. (2015). MAGMA: generalized gene-set analysis of GWAS data.&nbsp;<em>PLoS computational biology</em>,&nbsp;<em>11</em>(4), e1004219. <a href="https://doi.org/10.1371/journal.pcbi.1004219https://doi.org/10.1371/journal.pcbi.1004219">https://doi.org/10.1371/journal.pcbi.1004219</a></div>
</div>
<p>&nbsp;</p>
</section>
<section id="references" class="level1">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-sun2023" class="csl-entry">
Sun, Lei, Zhong Wang, Tianyuan Lu, Teri A. Manolio, and Andrew D. Paterson. 2023. <span>‚ÄúeXclusionarY: Ten Years Later, Where Are the Sex Chromosomes in GWAS?‚Äù</span> <a href="http://dx.doi.org/10.1101/2023.02.03.526992">http://dx.doi.org/10.1101/2023.02.03.526992</a>.
</div>
</div></section></div> ]]></description>
  <category>GWAS</category>
  <category>Gene analysis</category>
  <category>Gene Set Enrichment</category>
  <category>SNP summary statistics</category>
  <guid>https://daianna21.github.io/daianna_blog/posts/2024-07-16-MAGMA/</guid>
  <pubDate>Tue, 16 Jul 2024 06:00:00 GMT</pubDate>
  <media:content url="https://daianna21.github.io/daianna_blog/posts/2024-07-16-MAGMA/images/logo.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Fisher‚Äôs exact test</title>
  <dc:creator>Daianna Gonzalez-Padilla</dc:creator>
  <link>https://daianna21.github.io/daianna_blog/posts/2024-07-13-Fisher_test/</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>le</p>


</section>

 ]]></description>
  <category>overrepresentation</category>
  <category>enrichment</category>
  <category>GO</category>
  <category>KEGG</category>
  <guid>https://daianna21.github.io/daianna_blog/posts/2024-07-13-Fisher_test/</guid>
  <pubDate>Fri, 12 Jul 2024 06:00:00 GMT</pubDate>
  <media:content url="https://daianna21.github.io/daianna_blog/posts/2024-07-13-Fisher_test/images/logo.png" medium="image" type="image/png" height="146" width="144"/>
</item>
</channel>
</rss>
